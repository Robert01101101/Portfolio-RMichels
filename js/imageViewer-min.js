const imageViewer=document.getElementById("imageViewer");var newDiv,clone,originImage,next,prev,closeBtn,expand,compress,body=document.getElementsByTagName("BODY")[0],mainGrid=document.getElementById("MainGrid"),viewerOpen=!1,zoomed=!1,origInnerHTML=imageViewer.innerHTML;function viewImage(e,s=!1){if(("string"==typeof e||e instanceof String)&&(e=document.getElementById(e)),viewerOpen&&!s);else{document.documentElement.classList.add("stop-scrolling"),body.classList.add("stop-scrolling"),mainGrid.classList.add("stop-scrolling"),tmpDisableImg=!0,imageViewer.innerHTML="",originImage=e,viewerOpen=!0,(clone=e.cloneNode(!0)).removeAttribute("onclick"),imageViewer.appendChild(clone),clone.innerHTML+=origInnerHTML;var n=e.getElementsByTagName("img")[0],i=clone.getElementsByTagName("img")[0];imageViewer.classList.contains("hidden")&&imageViewer.classList.remove("hidden"),s||initCarousel();next=document.getElementsByClassName("next")[0],prev=document.getElementsByClassName("prev")[0],expand=document.getElementsByClassName("fa-expand")[0],compress=document.getElementsByClassName("fa-compress")[0],closeBtn=document.getElementsByClassName("closeBtn")[0],next.classList.add("hidden"),prev.classList.add("hidden"),closeBtn.classList.add("hidden"),setTimeout((function(){tmpDisableImg=!1,updateArrows()}),10),setTimeout((function(){if(n.naturalHeight>window.innerHeight+window.innerHeight/10||e.hasAttribute("fullscreen"))clone.classList.add("tall"),clone.innerHTML=origInnerHTML,(newDiv=document.createElement("div")).id="imgOverlayDivContainer",(newDiv=clone.appendChild(newDiv)).appendChild(i);else{var s=[];s=clone.getElementsByTagName("i"),(s=Array.prototype.slice.call(s)).forEach((e=>{e.classList.contains("hidden")||e.classList.add("hidden")}))}var t=clone.getElementsByTagName("figcaption")[0];void 0===t&&(null!=(t=(t=originImage.parentNode.parentNode.getElementsByTagName("figcaption")[0]).cloneNode(!0))&&clone.appendChild(t));(i.offsetHeight>window.innerHeight-100||e.hasAttribute("fullscreen"))&&null!=t&&t.classList.add("fullscreenCaption")}),20)}}function closeImageViewer(){viewerOpen=!1,zoomed=!1,imageViewer.classList.contains("hidden")||imageViewer.classList.add("hidden"),imageViewer.innerHTML=origInnerHTML,document.documentElement.classList.contains("stop-scrolling")&&document.documentElement.classList.remove("stop-scrolling"),body.classList.contains("stop-scrolling")&&body.classList.remove("stop-scrolling"),mainGrid.classList.contains("stop-scrolling")&&mainGrid.classList.remove("stop-scrolling")}var tmpDisableImg=!1;function expandView(e){document.getElementById("fullScreenExpand").classList.add("hidden"),document.getElementById("fullScreenCompress").classList.remove("hidden"),document.getElementById("imgOverlayDivContainer").classList.remove("tall"),e.classList.add("hidden"),zoomed=!1}function compressView(e){document.getElementById("fullScreenExpand").classList.remove("hidden"),document.getElementById("fullScreenCompress").classList.add("hidden"),document.getElementById("imgOverlayDivContainer").classList.add("tall"),e.classList.add("hidden"),zoomed=!0}document.addEventListener("click",(function(e){imageViewer.classList.contains("hidden")||tmpDisableImg||(clone.contains(e.target)||closeImageViewer())})),document.onkeydown=function(e){var s=!1,n=!1,i=!1;"key"in(e=e||window.event)?(s="Escape"===e.key||"Esc"===e.key,n="ArrowLeft"===e.key,i="ArrowRight"===e.key):(s=27===e.keyCode,n=37===e.keyCode,i=39===e.keyCode),s?closeImageViewer():n?plusSlides(-1):i&&plusSlides(1)};for(var slideIndex,allImages=document.querySelectorAll("figure"),imgArray=[],i=0;i<allImages.length;i++)allImages[i].hasAttribute("ignorecarousel")||imgArray.push(allImages[i]);function initCarousel(){var e;for(i=0;i<imgArray.length;i++)imgArray[i]===originImage&&(e=i);slideIndex=e}function plusSlides(e){zoomed=!1,0===slideIndex&&e<0||slideIndex===imgArray.length-1&&e>0||viewImage(imgArray[slideIndex+=e],!0)}let touchstartX=0,touchendX=0;function checkDirection(){!zoomed&&viewerOpen&&(touchendX<touchstartX&&plusSlides(1),touchendX>touchstartX&&plusSlides(-1))}function updateArrows(){document.body.clientWidth-clone.getBoundingClientRect().width<170?(next.classList.contains("flip")||next.classList.add("flip"),prev.classList.contains("flip")||prev.classList.add("flip"),closeBtn.classList.contains("flip")||closeBtn.classList.add("flip"),expand.classList.contains("flip")||expand.classList.add("flip"),compress.classList.contains("flip")||compress.classList.add("flip")):(next.classList.contains("flip")&&next.classList.remove("flip"),prev.classList.contains("flip")&&prev.classList.remove("flip"),closeBtn.classList.contains("flip")&&closeBtn.classList.remove("flip"),expand.classList.contains("flip")&&expand.classList.remove("flip"),compress.classList.contains("flip")&&compress.classList.remove("flip")),next.classList.remove("hidden"),prev.classList.remove("hidden"),closeBtn.classList.remove("hidden"),0==slideIndex?prev.classList.contains("end")||prev.classList.add("end"):slideIndex==imgArray.length-1?next.classList.contains("end")||next.classList.add("end"):(prev.classList.contains("end")&&prev.classList.remove("end"),next.classList.contains("end")&&next.classList.remove("end"))}function is_touch_enabled(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}document.addEventListener("touchstart",(e=>{touchstartX=e.changedTouches[0].screenX})),document.addEventListener("touchend",(e=>{touchendX=e.changedTouches[0].screenX,checkDirection()})),window.onresize=updateArrows,is_touch_enabled()&&imageViewer.classList.add("touchscreen");